<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Panel â€” Transporte Escolar</title>
  <link rel="stylesheet" href="../assets/css/styles.css" />
</head>
<body>
  <header class="topbar">
    <div class="topbar-left">
      <a class="brand link" href="../index.html">
        <span class="brand-emoji">ğŸšŒ</span>
        <div>
          <div class="brand-title">Transporte Escolar</div>
          <div class="brand-sub" id="subHeader">Panel</div>
        </div>
      </a>
    </div>
    <div class="topbar-right toolbar">
      <button class="iconbtn" id="btnHome" title="Inicio">ğŸ </button>
      <button class="iconbtn" id="btnSpeak" title="Leer contenido">ğŸ—£ï¸</button>
      <button class="iconbtn" id="btnTheme" title="Tema">ğŸŒ“</button>
      <button class="iconbtn" id="btnContrast" title="Alto contraste">ğŸŒ—</button>
      <button class="iconbtn" id="btnAPlus" title="A+">A+</button>
      <button class="iconbtn" id="btnAMinus" title="Aâˆ’">Aâˆ’</button>
      <button class="iconbtn" id="btnLang" title="Idioma">ğŸŒ</button>
      <span class="pill" id="userPill">â€”</span>
      <button class="btn ghost" id="btnLogout">Salir</button>
    </div>
  </header>

  <main class="container">
    <section class="grid cols-3">
      <div class="card glass hoverlift">
        <div class="row space">
          <h2 class="h2">ğŸ§¾ Base</h2>
          <a class="btn ghost" href="../tools/importer.html">ğŸ§° Importar</a>
        </div>
        <div class="kv">
          <div><span class="k">Estado</span><span class="v" id="dbStatus">â€”</span></div>
          <div><span class="k">Estudiantes</span><span class="v" id="dbCount">â€”</span></div>
          <div><span class="k">Hoja</span><span class="v" id="dbSheet">â€”</span></div>
        </div>
        <div class="notice small">Si el panel aparece vacÃ­o, vuelve a importar el Excel.</div>
      </div>

      <div class="card glass hoverlift">
        <h2 class="h2">ğŸšŒ Buses</h2>
        <div class="row">
          <button class="btn primary" id="btnAddBus">â• Agregar bus</button>
          <button class="btn ghost" id="btnManageBuses">âš™ï¸ Gestionar</button>
        </div>
        <div id="busSummary" class="mini-list"></div>
      </div>

      <div class="card glass hoverlift">
        <h2 class="h2">ğŸ—ºï¸ Zonas</h2>
        <div class="row">
          <button class="btn primary" id="btnAddZone">â• Agregar zona</button>
          <button class="btn ghost" id="btnManageZones">âš™ï¸ Gestionar</button>
        </div>
        <div id="zoneSummary" class="mini-list"></div>
      </div>
    </section>

    <section class="card glass">
      <div class="row space">
        <h2 class="h2">ğŸ” AsignaciÃ³n rÃ¡pida por RUT</h2>
        <div class="row">
          <button class="btn ghost" id="btnExport">ğŸ“¤ Exportar Excel</button>
          <button class="btn ghost" id="btnBackup">ğŸ’¾ Respaldo</button>
        </div>
      </div>

      <div class="grid cols-2">
        <div class="card inner">
          <label class="field">
            <span>RUT estudiante</span>
            <input id="rutInput" placeholder="12345678-9" inputmode="text" autocomplete="off">
          </label>

          <div class="row">
            <button class="btn primary hoverlift" id="btnFind">ğŸ” Buscar</button>
            <button class="btn ghost" id="btnSuggest">ğŸ¤– Sugerir bus</button>
            <button class="btn ghost" id="btnClear">ğŸ§¹ Limpiar</button>
          </div>

          <div id="findMsg" class="msg" aria-live="polite"></div>
          <div class="hr"></div>

          <div class="row space">
            <div class="pill">AsignaciÃ³n</div>
            <div class="pill" id="seatInfo">â€”</div>
          </div>

          <label class="field">
            <span>Zona</span>
            <select id="zoneSelect"></select>
          </label>

          <label class="field">
            <span>Bus</span>
            <select id="busSelect"></select>
            <div class="hint">Si el bus estÃ¡ lleno, el estudiante pasa automÃ¡ticamente a <strong>En espera</strong>.</div>
          </label>

          <label class="field">
            <span>Recorrido (texto)</span>
            <input id="routeInput" placeholder="Ej: LantaÃ±o â†’ Centro â†’ Liceo">
          </label>

          <button class="btn success hoverlift" id="btnAssign">âœ… Asignar / Enviar a espera</button>
        </div>

        <div class="card inner">
          <div class="row space">
            <h3 class="h3">ğŸ‘¦ğŸ‘§ Ficha estudiante</h3>
            <div class="pill" id="studentState">â€”</div>
          </div>
          <div id="studentCard" class="student-card empty">
            <div class="muted">Ingresa un RUT y presiona <strong>Buscar</strong>.</div>
          </div>

          <div class="hr"></div>

          <div class="row space">
            <h3 class="h3">â³ En espera</h3>
            <span class="pill" id="waitCount">0</span>
          </div>
          <div id="waitList" class="mini-list"></div>
        </div>
      </div>
    </section>

    <section class="grid cols-2">
      <div class="card glass">
        <h2 class="h2">ğŸ“Œ Ãšltimas asignaciones</h2>
        <div id="recentAssign" class="mini-list"></div>
      </div>

      <div class="card glass">
        <h2 class="h2">ğŸ§ª Herramientas</h2>
        <div class="grid cols-2">
          <a class="card action hoverlift" href="../tools/importer.html">
            <div class="card-emoji">ğŸ§°</div>
            <div class="card-title">Importar base</div>
            <div class="card-desc">Cargar Excel y mapear campos.</div>
          </a>
          <a class="card action hoverlift" href="../tools/backup.html">
            <div class="card-emoji">ğŸ’¾</div>
            <div class="card-title">Respaldo</div>
            <div class="card-desc">Exportar/importar estado (buses, zonas, asignaciones).</div>
          </a>
        </div>
      </div>
    </section>

    <footer class="footer small">
      <div class="footer-inner">
        <div class="footer-bar">
          <div class="logo">
            <img src="../assets/img/neotech.svg" alt="Neotech EduLab" class="logo-img" onerror="this.style.display='none'">
            <div><strong>Â© Neotech EduLab</strong> â€” EducaciÃ³n Inmersiva</div>
            <small>ğŸ› ï¸ Prohibida su copia y/o reproducciÃ³n</small>
          </div>
        </div>
      </div>
    </footer>
  </main>

  <div class="modal" id="modal" hidden>
    <div class="modal-backdrop" data-close="1"></div>
    <div class="modal-card">
      <div class="row space">
        <div class="modal-title" id="modalTitle">â€”</div>
        <button class="btn ghost" id="modalClose">âœ–</button>
      </div>
      <div id="modalBody"></div>
    </div>
  </div>

  <script src="../assets/js/ui.js"></script>
  <script src="../assets/js/storage.js"></script>
  <script src="../assets/js/auth.js"></script>
  <script src="../assets/js/modal.js"></script>
  <script src="../assets/js/dashboard.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</body>
</html>
